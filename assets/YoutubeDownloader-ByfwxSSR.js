import{j as e,W as w,o as m,p as P,Y as L,c2 as I,F as M,c3 as Y,av as V,k as J}from"./ui-vendor-DEvE63cZ.js";import{r as i}from"./react-vendor-BGp5FbCG.js";import{u as z}from"./index-DH-nAFKK.js";import{A as _,m as $}from"./framer-vendor-DEiCTn3G.js";import"./utils-vendor-CJFcDo9C.js";function H(){const{t:h}=z(),[r,O]=i.useState(""),[s,j]=i.useState(null),[v,N]=i.useState(!1),[k,c]=i.useState(null),[x,R]=i.useState(null),[d,D]=i.useState("video"),[g,y]=i.useState(null),[l,p]=i.useState({}),[F,q]=i.useState(!0),S=t=>{if(!t)return"--:--";if(typeof t=="string")return/^\d+$/.test(t)||/^\d+\.\d+$/.test(t)?S(parseFloat(t)):t;const o=Math.floor(t),a=Math.floor(o/3600),n=Math.floor(o%3600/60),u=o%60,f=A=>A.toString().padStart(2,"0");return a>0?`${a}:${f(n)}:${f(u)}`:`${n}:${f(u)}`};i.useEffect(()=>{window.ipcRenderer||(q(!1),c(h("youtube.electronRequired","This feature is only available in the desktop application.")))},[h]),i.useEffect(()=>{if(!window.ipcRenderer)return;const t=window.ipcRenderer.on("download:progress",(o,{url:a,percent:n})=>{p(u=>({...u,[a]:{...u[a],status:"downloading",progress:n}}))});return()=>{typeof t=="function"&&t()}},[]);const C=async()=>{if(r){if(!window.ipcRenderer){c("Desktop app required");return}N(!0),c(null),j(null);try{const t=await window.ipcRenderer.invoke("youtube:getInfo",r);j(t),t.type==="video"&&t.qualityOptions&&t.qualityOptions.length>0?y(t.qualityOptions[0]):y(null)}catch(t){c(t.message||"Failed to fetch info")}finally{N(!1)}}},E=async()=>{if(!window.ipcRenderer)return;const t=await window.ipcRenderer.invoke("youtube:selectFolder");t&&R(t)},b=async(t,o)=>{if(!x){c(h("youtube.selectFolderError","Please select a download folder first"));return}if(window.ipcRenderer){p(a=>({...a,[t]:{url:t,title:o,status:"pending",progress:0}}));try{await window.ipcRenderer.invoke("youtube:download",{url:t,type:d,outputDir:x,fileName:o,resolution:s?.type==="video"&&d==="video"?g?.height:void 0,fps:s?.type==="video"&&d==="video"?g?.fps:void 0}),p(a=>({...a,[t]:{...a[t],status:"completed",progress:100}}))}catch(a){p(n=>({...n,[t]:{...n[t],status:"error",error:a.message}}))}}},T=async()=>{if(s?.type==="playlist")for(const t of s.items)await b(t.url,t.title)};return F?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(m,{className:"w-8 h-8 text-red-600"}),"YouTube Downloader"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Download videos and playlists in high quality."})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",value:r,onChange:t=>O(t.target.value),placeholder:"Paste YouTube Video or Playlist URL",className:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-red-500 outline-none transition-all",onKeyDown:t=>t.key==="Enter"&&C()}),e.jsx(P,{className:"absolute left-3 top-2.5 w-5 h-5 text-gray-400"})]}),e.jsx("button",{onClick:C,disabled:v||!r,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors flex items-center gap-2",children:v?e.jsx(L,{className:"animate-spin w-5 h-5"}):"Fetch"})]}),k&&e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),k]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[e.jsxs("div",{className:"flex text-black dark:text-white items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Save to:"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:E,className:"px-3 py-1.5 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md text-sm flex items-center gap-2 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(I,{className:"w-4 h-4"}),x?x.split(/[\\/]/).pop()||x:"Select Folder"]})})]}),e.jsxs("div",{className:"flex text-black dark:text-white items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Format:"}),e.jsxs("div",{className:"flex bg-gray-200 dark:bg-gray-700 p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>D("video"),className:`px-3 py-1 text-sm rounded-md transition-all flex items-center gap-1 ${d==="video"?"bg-white dark:bg-gray-800 text-red-600 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900"}`,children:[e.jsx(M,{className:"w-4 h-4"})," Video"]}),e.jsxs("button",{onClick:()=>D("audio"),className:`px-3 py-1 text-sm rounded-md transition-all flex items-center gap-1 ${d==="audio"?"bg-white dark:bg-gray-800 text-red-600 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900"}`,children:[e.jsx(Y,{className:"w-4 h-4"})," Audio"]})]})]}),d==="video"&&s?.type==="video"&&s.qualityOptions&&s.qualityOptions.length>0&&e.jsxs("div",{className:"flex text-black dark:text-white items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Quality:"}),e.jsx("select",{value:g?JSON.stringify(g):"",onChange:t=>{t.target.value&&y(JSON.parse(t.target.value))},className:"px-3 py-1.5 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md text-sm outline-none focus:ring-2 focus:ring-red-500",children:s.qualityOptions.map((t,o)=>e.jsx("option",{value:JSON.stringify(t),children:t.label},o))})]})]}),e.jsx(_,{mode:"wait",children:s&&e.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-6 items-start",children:[e.jsx("img",{src:s.thumbnail,alt:s.title,className:"w-48 aspect-video object-cover rounded-lg shadow-md"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded text-white mb-2 inline-block ${s.type==="playlist"?"bg-blue-600":"bg-red-600"}`,children:s.type==="playlist"?"PLAYLIST":"VIDEO"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white line-clamp-2",children:s.title}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:s.type==="video"?s.author:`${s.videoCount} Videos`})]})}),s.type==="video"&&e.jsx("div",{className:"pt-2",children:e.jsxs("button",{onClick:()=>b(r,s.title),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(m,{className:"w-5 h-5"})," Download"]})}),s.type==="playlist"&&e.jsx("div",{className:"pt-2 flex items-center gap-4",children:e.jsxs("button",{onClick:T,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(m,{className:"w-5 h-5"})," Download All (",s.videoCount,")"]})})]})]}),s.type==="video"&&l[r]&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2 text-black dark:text-white",children:[e.jsx("span",{className:"font-medium truncate pr-4",children:l[r].title}),e.jsx("span",{className:l[r].status==="error"?"text-red-500":l[r].status==="completed"?"text-green-500":"text-blue-500",children:l[r].status==="downloading"?`${Math.round(l[r].progress||0)}%`:l[r].status.toUpperCase()})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx($.div,{initial:{width:0},animate:{width:`${l[r].progress||0}%`},className:`h-full ${l[r].status==="error"?"bg-red-500":l[r].status==="completed"?"bg-green-500":"bg-blue-500"}`})}),l[r].error&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l[r].error})]}),s.type==="playlist"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"})," Tracks"]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto space-y-2 pr-2 custom-scrollbar",children:s.items.map((t,o)=>{const a=l[t.url];return e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 transition-colors group",children:[e.jsx("span",{className:"text-gray-400 w-6 text-center",children:o+1}),e.jsx("img",{src:t.thumbnail,alt:"",className:"w-16 h-9 object-cover rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500",children:S(t.duration)})]}),a?e.jsx("div",{className:"w-24 text-right",children:a.status==="completed"?e.jsx(J,{className:"w-5 h-5 text-green-500 ml-auto"}):a.status==="error"?e.jsx(w,{className:"w-5 h-5 text-red-500 ml-auto"}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"text-xs text-right mb-1 text-blue-500",children:[Math.round(a.progress||0),"%"]}),e.jsx("div",{className:"h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${a.progress}%`}})})]})}):e.jsx("button",{onClick:()=>b(t.url,t.title),className:"p-2 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-all",children:e.jsx(m,{className:"w-5 h-5"})})]},o)})})]})]})})]})]}):e.jsxs("div",{className:"max-w-4xl mx-auto p-8 flex flex-col items-center justify-center space-y-4 text-center",children:[e.jsx("div",{className:"bg-orange-100 p-4 rounded-full",children:e.jsx(w,{className:"w-12 h-12 text-orange-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Desktop Required"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 max-w-md",children:"The YouTube Downloader feature relies on native system capabilities and is only available in the Dev Optimizer desktop application."}),e.jsx("button",{onClick:()=>window.open("https://github.com/pangphannarupp/dev-optimizer/releases","_blank"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Download Desktop App"})]})}export{H as YoutubeDownloader};
